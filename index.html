<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blog Mawan</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body.dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }
    body.dark-mode .card {
      background-color: #1e1e1e;
      border-color: #333;
    }
    body.dark-mode .card-title,
    body.dark-mode .card-text,
    body.dark-mode .text-muted {
      color: #e0e0e0 !important;
    }
    #mode-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
    }
    .card-img-top-wrapper {
      aspect-ratio: 16 / 9;
      overflow: hidden;
      background-color: #e0e0e0;
    }
    .card-img-top {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <button id="mode-toggle" class="btn btn-outline-secondary btn-sm">üåô Mode Gelap</button>

  <div class="container py-4">
    <h1 class="mb-4 text-center">Blog Mawan</h1>
    <div id="artikel-list" class="row gy-4"></div>

    <div id="artikel-lengkap" class="d-none">
      <button onclick="tampilkanDaftar()" class="btn btn-secondary mb-3">‚Üê Kembali ke Beranda</button>
      <div id="konten-lengkap"></div>
    </div>
  </div>

  <script>
    const daftarIsiURL = 'https://raw.githubusercontent.com/mawann/mawan.cms/refs/heads/main/daftar_isi.json';

    async function ambilDaftarArtikel() {
      try {
        const res = await fetch(daftarIsiURL);
        const data = await res.json();
        tampilkanDaftar(data);
      } catch (e) {
        alert("Gagal memuat daftar isi.");
      }
    }

    function tampilkanDaftar(data = []) {
      document.getElementById('artikel-lengkap').classList.add('d-none');
      const container = document.getElementById('artikel-list');
      container.innerHTML = '';

      data.forEach(item => {
        const col = document.createElement('div');
        col.className = 'col-12 col-md-6 col-lg-4';

        col.innerHTML = `
          <div class="card h-100 shadow-sm">
            <div class="card-img-top-wrapper">
              <img src="${item.url_gambar || 'https://via.placeholder.com/600x338?text=No+Image'}" 
                   class="card-img-top" 
                   alt="Gambar artikel"
                   onerror="this.onerror=null; this.src='https://via.placeholder.com/600x338?text=No+Image';" />
            </div>
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">${item.judul}</h5>
              <p class="card-text">${item.cuplikan}</p>
              <p class="text-muted small mt-auto">${item.penulis} ‚Äì ${item.waktu}</p>
              <button class="btn btn-primary mt-2" onclick="tampilkanArtikel('${item.url_artikel}')">Baca selanjutnya</button>
            </div>
          </div>`;
        container.appendChild(col);
      });

      container.classList.remove('d-none');
    }

    async function tampilkanArtikel(url) {
      try {
        const res = await fetch(url);
        const data = await res.json();
        const container = document.getElementById('konten-lengkap');
        container.innerHTML = `
          <h2>${data.judul}</h2>
          ${data.url_gambar ? `<img src="${data.url_gambar}" class="img-fluid mb-3" alt="Gambar artikel">` : ''}
          <p class="text-muted">${data.penulis} ‚Äì ${data.waktu}</p>
          <div>${data.isi}</div>
        `;
        document.getElementById('artikel-list').classList.add('d-none');
        document.getElementById('artikel-lengkap').classList.remove('d-none');
      } catch (e) {
        alert("Gagal memuat artikel.");
      }
    }

    // Dark/Light mode toggle
    const toggleBtn = document.getElementById('mode-toggle');
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      const dark = document.body.classList.contains('dark-mode');
      toggleBtn.textContent = dark ? '‚òÄÔ∏è Mode Terang' : 'üåô Mode Gelap';
    });

    ambilDaftarArtikel();
  </script>
</body>
</html>
